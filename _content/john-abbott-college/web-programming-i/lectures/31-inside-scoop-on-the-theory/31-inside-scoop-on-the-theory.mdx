---
# General Information
category: "Web Programming I"
title: "Inside Scoop on the Theory"
created: "2024-11-04"
number: 31
---

# JSON continued

We covered JSON at a high level in previous classes, today we cover it in greater detail

## What is it?

- A standard text-based format for representing structured data that's _very_ popular
- It's based on JavaScript object syntax, but it is independent of JavaScript (could be used anywhere)

## When do we use it?

- It's often used to transfer data from web server to browser (client).
- When we transfer it, it is represented as a string because that's great for transfer.

## How do we make sure JavaScript is happy when dealing with JSON?

JavaScript provides a JSON object with methods to convert it to a JavaScript object.

# JSON vs JavaScript

## JSON data types

In JSON, values must be one of the following data types:

- a string (e.g. `"Don't Panic"`)
- a number (e.g. `42`)
- an object (e.g. JSON object)
- an array (e.g. `[stuff]`)
- a boolean (e.g. `true`/ `false`)
- `null` (angry user defined error)

## JavaScript data types

In JavaScript values can be all of the above, plus any other valid JavaScript expression, including:

- a function (e.g. `() => stuff`)
- a date
- `undefined` (angry JavaScript defined error)

## Examples

JSON Syntax:

```json
{
  "name": "Arthur Dent",
  "age": 42,
  "isPanicking": false,
  "items": ["blanket", "towel", "coffee"],
  "spaceship": null
}
```

Fun fact with the [autoformatter](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode) when you assign this object to a constant will immediately turn it into a JavaScript object :^)

JavaScript Object Syntax:

```js
// you cant put comments in a json file
const arthur = {
  name: "Arthur Dent",
  age: 42,
  isPanicking: false,
  items: ["blanket", "towel", "coffee"],
  spaceship: undefined, // JSON doesn't support undefined lol
  panic() {
    this.isPanicking = true;
    console.log("AHHHHHHH");
  },
};
```

## Key differences

JSON requires _double_ quotes to be used around _property names_ and _values_ that are strings (unlike in JavaScript). Single quotes are not valid.

Even a single misplaced comma or colon can cause a JSON file to go wrong. (which is always lovely when it happens)

# Usage and Parsing JSON

Sometimes we want to receive JSON from a server and sometimes we are the server that wants to send JSON.

## Examples

JavaScript object => JSON

```js
const jsonString = JSON.stringify(arthur);
console.log(jsonString); // notice how some previously defined properties disappear
```

JSON => JavaScript object

```js
const processedArthur = JSON.parse(jsonString);
console.log(processedArthur);
```

# Common use cases and best practices

## Response.json()

Remember this example from yesterday?

```js
const response = await fetch(url);
const json = await response.json();
```

`response.json()` in JavaScript automatically parses the JSON for you, so you don't need to use `JSON.parse()` on the result.

## localStorage / sessionStorage

Data stored in localStorage or sessionStorage is stored as a string, so when we retrieve it, we need to parse it into an object to work with it.

```js
// Saving Arthur to localStorage
localStorage.setItem("storedArthur", JSON.stringify(arthur));

// Retrieving Arthur and parsing him
const storedArthur = localStorage.getItem("storedArthur");
const parsedArthur = JSON.parse(storedArthur);
console.log(parsedArthur); // notice which attributes are missing
```

# Exercise 1

# defer / async

More info: https://javascript.info/script-async-defer

```html
<script src="myFile.js"></script>

<script defer src="myFile.js"></script>

<script async src="myFile.js"></script>
```

What's going on here?

```html
<script defer src="myFile.js"></script>
load file in background (get it from server) run js code only when DOM is ready
(can retrieve HTML Element object in script)

<script async src="myFile.js"></script>
load file in background (get it from server) run js code as soon as file loaded.
(DOM might not be ready)

<script src="myFile.js"></script>
load file right away (block rest of page) run js code as soon as file loaded.
(DOM might not be ready)
```

## Whats the steps?

https://www.growingwiththeweb.com/2014/02/async-vs-defer-attributes.html#script

The async attribute is useful when the script is not used for DOM manipulation. Sometimes you need a script only for server-side operations or for handling cache or cookies, but not for DOM manipulations.

The defer attribute is important when the script is used for DOM manipulations.
defer scripts are guaranteed to execute in order.

# Friday Quiz

Focus on Ajax and the differences between traditional promises vs modern promises

# setTimeout function

takes in two parameters:
The function to run after the specified time. The function takes no parameters.
The specified time in ms.
