---
# General Information
category: "Web Programming I"
title: "Event Bubbling"
created: "2024-09-22"
number: 14
coverSrc: "./assets/4.png"
---

# Introduction

We have been learning about Event Listeners for the last bit and different types of events. Today, we are going to make more sense of this conceptually.

Today's class focus will be on the ideas of event propagation, bubbling, and capturing. What are all these spooky terms? It's best explained with an example.

# Event Bubbling

Let's say we got three `<div>` elements organized in this order:

```js
<div class="one">
  <div class="two">
    <div class="three"></div>
  </div>
</div>
```

And we want to make the `<div>` easier to interact with by adding the following styles

```css
div {
  padding: 50px;
}
.one {
  background-color: lavender;
}
.two {
  background-color: mistyrose;
}
.three {
  background-color: coral;
}
```

If we add the following vanilla JavaScript to our `<script>` tag, what do you think is going to `console.log()` when we click the inner most `<div>`?

```js
const divs = document.querySelectorAll("div");

function logClass() {
  console.log(this.classList.value);
}

divs.forEach(function (div) {
  div.addEventListener("click", logClass);
});
```

We should see this printed:

```text
three
two
one
```

Wait ok what's happening here. We just clicked on the `.third` one, but in the console we have `two` and `one` also being printed? Why?

Well if we navigate to our `Elements` tab in Chrome Devtools, we didn't just click on the `<div>` with class `three`, we also clicked on `two` which is in `one` which is in the `body` which is in the `html` which is in the current tab which is in chrome which is on your computer which is sitting in John Abbott, and so on...

![demo](./assets/1.png)

It just keeps zooming out and out. This is the core concept of "bubbling".

## What is bubbling?

The browser will figure out what you clicked on, but it will also trigger clicks up every element up the DOM tree.

Think of this as the butterfly effect of the DOM.

![butterfly](./assets/4.png)

# Example

Lets say we add an event listener of `click` to the body, what do you think is going to happen next?

```js
document.body.addEventListener("click", logClass);
```

Well, we should see the following:

```text
three
two
one
body
```

Here the event will ripple all the way to the top of the document and trigger `click`s on those elements. You don't always see that because you may not be listening for them, but they are there and this behavior becomes evident when we have multiple nested event listeners.

## How does this work in JavaScript?

The way that this works in modern browsers is that the browser will first do something called a "capture", when you click on the element it will actually ripple down from top down to capture all those events. It hasn't fired them yet they are just being temporarily stored. What the browser is doing is trying to figure out what you clicked. Once it knows where you have clicked, it will finally begin triggering that from the bottom up.

![demo](./assets/3.png)

## How can we prevent this?

If we want to prevent this from happening we can alter our `addEventListener` as follows:

```js
divs.forEach(function (div) {
  // this is an "options" object
  div.addEventListener("click", logClass, {
    capture: true, // notice me
  });
});
```

Which will cause the following logs:

```text
one
two
three
```

Why? `capture: true` will cause our function to run not on the bubble up, but the capture down.

That is what capture means. The event is being "captured". Think of this as the zooming in of your camera and you are trying to focus on a particular element, and in our case this is the inner most `<div>`.

However the default of this "options" object is "false":

```js
divs.forEach(function (div) {
  div.addEventListener("click", logClass, {
    capture: false, // notice me AGAIN
  });
});
```

## How do we prevent bubbling?

Ok so we see how events bubble up. First lets change our function as follows:

```js
function logClass(event) {
  console.log(this.classList.value);
  event.stopPropagation(); // notice me
}
```

What is going to happen if we click the inner most div? This time we should just see this printed to console:

```text
three
```

Why? What happens once it runs the function once, it will no longer trigger events on the parents

## How does this relate to DOMReady?

## How does this relate to Load?
